<div class="flex flex-col my-2 items-center gap-2">
	<p class="m-0!">Fechas disponibles:</p>
	<p-select
		[options]="startMonitorings()"
		[showClear]="false"
		[filter]="true"
		appendTo="body"
		[(ngModel)]="startMonitoring"
	>
		<ng-template #selectedItem let-selectedOption>
			<div>{{ selectedOption?.coverageDate | date: 'dd/MM/yyyy' : 'UTC' }}: {{ selectedOption.name }}</div>
		</ng-template>
		<ng-template #item let-item>
			<div>{{ item?.coverageDate | date: 'dd/MM/yyyy' : 'UTC' }}: {{ item.name }}</div>
		</ng-template>
	</p-select>

	<p-select
		[options]="endMonitorings()"
		[showClear]="false"
		[filter]="true"
		appendTo="body"
		[(ngModel)]="endMonitoring"
	>
		<ng-template #selectedItem let-selectedOption>
			<div>{{ selectedOption?.coverageDate | date: 'dd/MM/yyyy' : 'UTC' }}: {{ selectedOption.name }}</div>
		</ng-template>
		<ng-template #item let-item>
			<div>{{ item?.coverageDate | date: 'dd/MM/yyyy' : 'UTC' }}: {{ item.name }}</div>
		</ng-template>
	</p-select>

	<p-button label="Procesar" (onClick)="processQuery()" [disabled]="isLoading()"></p-button>
</div>

@if (!isLoading()) {
	<div style="height: 400px">
		<p-chart type="bar" height="400" [data]="generalData()" [options]="generalOptions"> </p-chart>
	</div>
} @else {
	<app-loader></app-loader>
}

@if (isLoading()) {
	<app-loader></app-loader>
} @else {
	<p-tabs value="0" (valueChange)="onTabChange($event)" [scrollable]="true">
		<p-tablist>
			<p-tab value="0">Limites Administrativos</p-tab>
			<p-tab value="1">TCOS</p-tab>
			<p-tab value="2">Áreas Protegidas</p-tab>
			<p-tab value="3">Sitios Ramsar</p-tab>
		</p-tablist>

		<p-tabpanels>
			<p-tabpanel value="0">
				<app-bar-chart
					[chartData]="provData()"
					label="Provincias"
					[selectOptions]="provinces"
					(onChangeData)="onProvinceChange($event)"
					(onBarClick)="onBarClick($event, 'prov')"
				>
				</app-bar-chart>

				<app-bar-chart
					[chartData]="munData()"
					label="Municipios"
					[selectOptions]="municipalities"
					(onChangeData)="onMunicipalityChange($event)"
					(onBarClick)="onBarClick($event, 'mun')"
				>
				</app-bar-chart>
			</p-tabpanel>
			<p-tabpanel value="1">
				<app-bar-chart
					[chartData]="tcosData()"
					label="TCOS"
					[selectOptions]="tcos"
					(onChangeData)="onTcosChange($event)"
					(onBarClick)="onBarClick($event, 'tcos')"
				>
				</app-bar-chart>
			</p-tabpanel>
			<p-tabpanel value="2">
				<app-bar-chart
					[chartData]="apsData()"
					label="Areas Protegídas"
					[selectOptions]="aps"
					(onChangeData)="onApsChange($event)"
					(onBarClick)="onBarClick($event, 'aps')"
				>
				</app-bar-chart>
			</p-tabpanel>
			<p-tabpanel value="3">
				<app-bar-chart
					[chartData]="ramsarData()"
					label="Sitios Ramsar"
					[selectOptions]="ramsars"
					(onChangeData)="onRamsarChange($event)"
					(onBarClick)="onBarClick($event, 'ramsar')"
				>
				</app-bar-chart>
			</p-tabpanel>
		</p-tabpanels>
	</p-tabs>
}
